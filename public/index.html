<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="naver-site-verification" content="59fd3a0780caa70b37b5ae1976725f79a5e6b0c4" />
  <title>ë–¼ì¸ ëˆ ê³„ì‚°ê¸° - ìƒí™©ë³„ ë¯¸ìˆ˜ê¸ˆ ê°€ì´ë“œ</title>
  <meta name="description" content="í”„ë¦¬ëœì„œÂ·ì§€ì¸Â·ê±°ë˜ì²˜ ë¯¸ìˆ˜ê¸ˆ ìƒí™©ì„ ìœ í˜•ë³„ë¡œ ëª¨ì•„, ì§€ì—°ì´ì ê³„ì‚° ë„êµ¬ì™€ í•¨ê»˜ ì°¸ê³ í•  ìˆ˜ ìˆëŠ” ì¼ë°˜ì ì¸ ëŒ€ì‘ íë¦„ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.">
  <link rel="stylesheet" href="./styles.css">
  <style>
    /* í•„í„°/ê²€ìƒ‰ ì˜ì—­ ìŠ¤íƒ€ì¼ */
    .filter-section {
      margin-bottom: 24px;
    }
    .search-box {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      margin-bottom: 16px;
      transition: border-color 0.2s;
    }
    .search-box:focus {
      outline: none;
      border-color: #3b82f6;
    }
    .category-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }
    .category-btn {
      padding: 8px 16px;
      border: 1px solid #e5e7eb;
      border-radius: 20px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    .category-btn:hover {
      background: #f3f4f6;
    }
    .category-btn.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    .sort-controls {
      display: flex;
      gap: 8px;
      align-items: center;
      font-size: 14px;
      color: #6b7280;
    }
    .sort-btn {
      padding: 6px 12px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }
    .sort-btn:hover {
      background: #f3f4f6;
    }
    .sort-btn.active {
      background: #1f2937;
      color: white;
      border-color: #1f2937;
    }
    .results-count {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 16px;
    }
    .no-results {
      text-align: center;
      padding: 48px 24px;
      color: #6b7280;
    }
    .no-results-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }
    .loading {
      text-align: center;
      padding: 48px 24px;
      color: #6b7280;
    }
    .loading-spinner {
      display: inline-block;
      width: 32px;
      height: 32px;
      border: 3px solid #e5e7eb;
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    /* í˜ì´ì§€ë„¤ì´ì…˜ */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 32px;
    }
    .page-btn {
      padding: 8px 14px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    .page-btn:hover:not(:disabled) {
      background: #f3f4f6;
    }
    .page-btn.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="site-shell">
    <header class="site-header">
      <a class="brand" href="./index.html"><span>ğŸ’¸</span>ë–¼ì¸ ëˆ ê³„ì‚°ê¸°</a>
      <a class="ghost-link" href="./calculator.html">ë–¼ì¸ ëˆ ê³„ì‚°ê¸° ì—´ê¸°</a>
    </header>

    <section class="hero">
      <div class="pill">ë¯¸ìˆ˜ê¸ˆ ìƒí™©ë³„ ì •ë¦¬</div>
      <h1>ë–¼ì¸ ëˆ ê³„ì‚°ê¸°</h1>
      <p class="subtitle">
        ì†Œì•¡ ì²´ë¶ˆë¶€í„° ì§€ì¸ ëŒ€ì—¬ê¸ˆê¹Œì§€, ìì£¼ ê²ªëŠ” ë¯¸ìˆ˜ê¸ˆ ìƒí™©ë“¤ì„ ë¬¶ì–´ ì†Œê°œí•©ë‹ˆë‹¤.
      </p>
      <p class="intro">
        ì´ í˜ì´ì§€ëŠ” 'ë–¼ì¸ ëˆ ê³„ì‚°ê¸°'ì™€ í•¨ê»˜ ë³´ëŠ” ìƒí™©ë³„ ì•ˆë‚´ ëª¨ìŒì…ë‹ˆë‹¤. ì•„ë˜ ì‚¬ë¡€ë“¤ì€ ì‹¤ì œë¡œ ë§ì´ ë‚˜ì˜¤ëŠ” ë¯¸ìˆ˜ê¸ˆ ìƒí™©ì„ ë°”íƒ•ìœ¼ë¡œ, ì–´ë–¤ ì ì„ ë¯¸ë¦¬ ì •ë¦¬í•´ ë‘ë©´ ì¢‹ì€ì§€ì™€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ê³ ë¯¼í•´ ë³¼ ìˆ˜ ìˆëŠ” ì„ íƒì§€ë¥¼ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ê° ê°€ì´ë“œëŠ” ì¼ë°˜ì ì¸ ì •ë³´ë¥¼ ë‹´ì€ ê²ƒìœ¼ë¡œ, ê°œë³„ ì‚¬ê±´ì— ëŒ€í•œ ë²•ë¥  ìë¬¸ì´ë‚˜ í•´ê²°ì„ ë³´ì¥í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.
      </p>
    </section>

    <section class="section">
      <h2>ìƒí™©ë³„ ê°€ì´ë“œ ëª©ë¡</h2>
      
      <!-- í•„í„°/ê²€ìƒ‰ ì˜ì—­ -->
      <div class="filter-section">
        <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” ì œëª©ì´ë‚˜ ì„¤ëª…ìœ¼ë¡œ ê²€ìƒ‰...">
        
        <div class="category-filters" id="categoryFilters">
          <!-- ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ë“¤ì´ JavaScriptë¡œ ì‚½ì…ë¨ -->
        </div>
        
        <div class="sort-controls">
          <span>ì •ë ¬:</span>
          <button class="sort-btn active" data-sort="newest">ìµœì‹ ìˆœ</button>
          <button class="sort-btn" data-sort="oldest">ì˜¤ë˜ëœìˆœ</button>
          <button class="sort-btn" data-sort="title">ì œëª©ìˆœ</button>
        </div>
      </div>
      
      <div id="resultsCount" class="results-count"></div>
      
      <!-- ê°€ì´ë“œ ëª©ë¡ -->
      <div class="grid" id="guideGrid">
        <div class="loading">
          <div class="loading-spinner"></div>
          <p>ê°€ì´ë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
      </div>
      
      <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
      <div class="pagination" id="pagination"></div>
    </section>

    <section class="section">
      <h2>ë–¼ì¸ ëˆ ê³„ì‚°ê¸° ë°”ë¡œ ì‚¬ìš©í•˜ê¸°</h2>
      <p>ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ë™ì‘í•˜ë©° ì…ë ¥ê°’ì„ ì„œë²„ì— ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì›ê¸ˆê³¼ ì§€ê¸‰ ì˜ˆì •ì¼ë§Œ ë„£ì–´ ì§€ì—°ì´ìì™€ ì´ ì²­êµ¬ì•¡ì„ í™•ì¸í•´ ë³´ì„¸ìš”.</p>
      <a class="cta" href="./calculator.html">ê³„ì‚°ê¸° ì—´ê¸°</a>
    </section>

    <p class="footer">ë³¸ í˜ì´ì§€ë“¤ì€ ë²•ë¥  ìë¬¸ì´ ì•„ë‹ˆë©°, ì‹¤ì œ ì¡°ì¹˜ ì „ì—ëŠ” ê´€ë ¨ ê¸°ê´€ ì•ˆë‚´ë‚˜ ë²•ë¥  ì „ë¬¸ê°€ì˜ ëŒ€ì‘ ì ˆì°¨ ì•ˆë‚´ë¥¼ ì°¸ê³ í•´ ì£¼ì„¸ìš”.</p>
    <!-- Netlify ë°°í¬ ì‹œ `public/`ì„ ë£¨íŠ¸ë¡œ ì„¤ì •í•˜ë©´ ë°”ë¡œ ë™ì‘í•©ë‹ˆë‹¤. -->
    <p class="footer" style="font-size:12px;color:#6b7280;">ë³¸ í˜ì´ì§€ì˜ ì•ˆë‚´ëŠ” ì¼ë°˜ì ì¸ ì ˆì°¨ë¥¼ ì •ë¦¬í•œ ê²ƒìœ¼ë¡œ, ê°œë³„ ì‚¬ê±´ì— ëŒ€í•œ ë²•ë¥  ìë¬¸ì´ ì•„ë‹™ë‹ˆë‹¤.</p>
  </div>

  <script>
    // ========== ìƒíƒœ ==========
    let allPages = [];
    let filteredPages = [];
    let currentCategory = 'all';
    let currentSort = 'newest';
    let searchQuery = '';
    const ITEMS_PER_PAGE = 12;
    let currentPage = 1;

    // ========== DOM ìš”ì†Œ ==========
    const guideGrid = document.getElementById('guideGrid');
    const categoryFilters = document.getElementById('categoryFilters');
    const searchInput = document.getElementById('searchInput');
    const resultsCount = document.getElementById('resultsCount');
    const pagination = document.getElementById('pagination');

    // ========== ì´ˆê¸°í™” ==========
    async function init() {
      try {
        const response = await fetch('./pages.json');
        if (!response.ok) throw new Error('Failed to fetch pages.json');
        allPages = await response.json();
        
        // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ìƒì„±
        renderCategoryButtons();
        
        // ì •ë ¬ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.querySelectorAll('.sort-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentSort = btn.dataset.sort;
            currentPage = 1;
            applyFiltersAndRender();
          });
        });
        
        // ê²€ìƒ‰ ì´ë²¤íŠ¸
        searchInput.addEventListener('input', (e) => {
          searchQuery = e.target.value.trim().toLowerCase();
          currentPage = 1;
          applyFiltersAndRender();
        });
        
        // ì´ˆê¸° ë Œë”ë§
        applyFiltersAndRender();
      } catch (error) {
        console.error('Error loading pages:', error);
        guideGrid.innerHTML = `
          <div class="no-results">
            <div class="no-results-icon">ğŸ˜µ</div>
            <p>ê°€ì´ë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
            <p style="font-size: 12px; margin-top: 8px;">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.</p>
          </div>
        `;
      }
    }

    // ========== ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ìƒì„± ==========
    function renderCategoryButtons() {
      // ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ ë° ì¤‘ë³µ ì œê±°
      const categories = [...new Set(allPages.map(p => p.category).filter(Boolean))];
      categories.sort();
      
      let html = '<button class="category-btn active" data-category="all">ì „ì²´</button>';
      categories.forEach(cat => {
        html += `<button class="category-btn" data-category="${cat}">${cat}</button>`;
      });
      categoryFilters.innerHTML = html;
      
      // ì´ë²¤íŠ¸ ë°”ì¸ë”©
      categoryFilters.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          categoryFilters.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentCategory = btn.dataset.category;
          currentPage = 1;
          applyFiltersAndRender();
        });
      });
    }

    // ========== í•„í„° ë° ì •ë ¬ ì ìš© ==========
    function applyFiltersAndRender() {
      // í•„í„°ë§
      filteredPages = allPages.filter(page => {
        // ì¹´í…Œê³ ë¦¬ í•„í„°
        if (currentCategory !== 'all' && page.category !== currentCategory) {
          return false;
        }
        // ê²€ìƒ‰ í•„í„°
        if (searchQuery) {
          const title = (page.title || '').toLowerCase();
          const desc = (page.description || '').toLowerCase();
          const cat = (page.category || '').toLowerCase();
          if (!title.includes(searchQuery) && !desc.includes(searchQuery) && !cat.includes(searchQuery)) {
            return false;
          }
        }
        return true;
      });
      
      // ì •ë ¬
      filteredPages.sort((a, b) => {
        if (currentSort === 'newest') {
          return new Date(b.created_at || 0) - new Date(a.created_at || 0);
        } else if (currentSort === 'oldest') {
          return new Date(a.created_at || 0) - new Date(b.created_at || 0);
        } else if (currentSort === 'title') {
          return (a.title || '').localeCompare(b.title || '', 'ko');
        }
        return 0;
      });
      
      // ë Œë”ë§
      renderPages();
      renderPagination();
      updateResultsCount();
    }

    // ========== í˜ì´ì§€ ë Œë”ë§ ==========
    function renderPages() {
      if (filteredPages.length === 0) {
        guideGrid.innerHTML = `
          <div class="no-results">
            <div class="no-results-icon">ğŸ”</div>
            <p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
            <p style="font-size: 12px; margin-top: 8px;">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë‚˜ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ ë³´ì„¸ìš”.</p>
          </div>
        `;
        return;
      }
      
      // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
      const start = (currentPage - 1) * ITEMS_PER_PAGE;
      const end = start + ITEMS_PER_PAGE;
      const pagesToRender = filteredPages.slice(start, end);
      
      let html = '';
      pagesToRender.forEach(page => {
        html += `
          <div class="card">
            <div class="tag">${page.category || 'ê¸°íƒ€'}</div>
            <h3>${page.title}</h3>
            <p>${page.description || ''}</p>
            <div class="btn-row">
              <a class="cta" href="./${page.slug}.html">ìƒì„¸ ë³´ê¸°</a>
            </div>
          </div>
        `;
      });
      guideGrid.innerHTML = html;
    }

    // ========== í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§ ==========
    function renderPagination() {
      const totalPages = Math.ceil(filteredPages.length / ITEMS_PER_PAGE);
      
      if (totalPages <= 1) {
        pagination.innerHTML = '';
        return;
      }
      
      let html = '';
      
      // ì´ì „ ë²„íŠ¼
      html += `<button class="page-btn" data-page="prev" ${currentPage === 1 ? 'disabled' : ''}>â† ì´ì „</button>`;
      
      // í˜ì´ì§€ ë²ˆí˜¸
      for (let i = 1; i <= totalPages; i++) {
        if (totalPages > 7) {
          // ë§ì€ í˜ì´ì§€ì¼ ë•Œ ì¶•ì•½ í‘œì‹œ
          if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
            html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
          } else if (i === currentPage - 2 || i === currentPage + 2) {
            html += `<span style="padding: 8px 4px;">...</span>`;
          }
        } else {
          html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
        }
      }
      
      // ë‹¤ìŒ ë²„íŠ¼
      html += `<button class="page-btn" data-page="next" ${currentPage === totalPages ? 'disabled' : ''}>ë‹¤ìŒ â†’</button>`;
      
      pagination.innerHTML = html;
      
      // ì´ë²¤íŠ¸ ë°”ì¸ë”©
      pagination.querySelectorAll('.page-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const page = btn.dataset.page;
          if (page === 'prev' && currentPage > 1) {
            currentPage--;
          } else if (page === 'next' && currentPage < totalPages) {
            currentPage++;
          } else if (!isNaN(parseInt(page))) {
            currentPage = parseInt(page);
          }
          applyFiltersAndRender();
          // ìŠ¤í¬ë¡¤ ì´ë™
          guideGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
      });
    }

    // ========== ê²°ê³¼ ìˆ˜ í‘œì‹œ ==========
    function updateResultsCount() {
      const total = filteredPages.length;
      const start = (currentPage - 1) * ITEMS_PER_PAGE + 1;
      const end = Math.min(currentPage * ITEMS_PER_PAGE, total);
      
      if (total === 0) {
        resultsCount.textContent = '';
      } else if (total <= ITEMS_PER_PAGE) {
        resultsCount.textContent = `ì´ ${total}ê°œì˜ ê°€ì´ë“œ`;
      } else {
        resultsCount.textContent = `ì´ ${total}ê°œ ì¤‘ ${start}-${end}ë²ˆì§¸ í‘œì‹œ`;
      }
    }

    // ========== ì‹œì‘ ==========
    init();
  </script>
</body>
</html>
